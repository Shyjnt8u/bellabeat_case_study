---
title: "Bellabeat Case Study"
author: "Sierra Paul"
date created: 02/21/24
output:
  html_document:
    df_print: paged
---

# **Case Study Background Information**
### **Dataset used:** [FitBit Fitness Tracker Data](https://www.kaggle.com/datasets/arashnic/fitbit)
Uploaded by: [Möbius](https://www.kaggle.com/arashnic)  
License: CC0:Public Domain  
  




## **About the company**
Urška Sršen and Sando Mur founded Bellabeat, a high-tech company that manufactures health-focused smart products.Sršen used her background as an artist to develop beautifully designed technology that informs and inspires women around
the world. Collecting data on activity, sleep, stress, and reproductive health has allowed Bellabeat to empower women with
knowledge about their own health and habits. Since it was founded in 2013, Bellabeat has grown rapidly and quickly positioned
itself as a tech-driven wellness company for women.

## Desired insights
* What are some trends in smart device usage?
* How could these trends apply to Bellabeat customers?
* How could these trends influence Bellabeat marketing strategy?

# Business Task:
Analyze smart device usage data and apply the insights in order to inform Bellabeat’s marketing strategy.


## Download needed packages
```{r}
library(tidyverse)
library(ggplot2)
library(lubridate)
library(dplyr)
library(tidyr)
library(janitor)
```
## Read in the files with daily data to be worked with, preview them, and get basic metrics of the data
```{r} 
# read in the tables 
activity <- read_csv("Data/Bellabeat_data/dailyActivity_merged.csv")
sleep <- read_csv("Data/Bellabeat_data/sleepDay_merged.csv")
steps <- read_csv("Data/Bellabeat_data/dailySteps_merged.csv")
intensities <- read_csv("Data/Bellabeat_data/dailyIntensities_merged.csv")
calories <- read_csv("Data/Bellabeat_data/dailyCalories_merged.csv")
weight <- read_csv("Data/Bellabeat_data/weightLogInfo_merged.csv")
hourly_steps <- read_csv("Data/Bellabeat_data/hourlySteps_merged.csv")
hourly_intensities <- read_csv("Data/Bellabeat_data/hourlyIntensities_merged.csv")

```

### preview tables
```{r} 
glimpse(activity)
glimpse(sleep)
glimpse(steps)
glimpse(intensities)
glimpse(calories)
glimpse(weight)
glimpse(hourly_intensities)
glimpse(hourly_steps)
```

### id count for all tables
```{r} 
n_distinct(activity$Id)
n_distinct(calories$Id)
n_distinct(intensities$Id)
n_distinct(sleep$Id)
n_distinct(weight$Id)
n_distinct(hourly_intensities$Id)
n_distinct(hourly_steps$Id)
```

### date check for all tables
```{r} 
n_distinct(activity$ActivityDate)
n_distinct(calories$ActivityDay)
n_distinct(intensities$ActivityDay)
n_distinct(sleep$SleepDay)  
```
  
### check for duplicates
```{r} 
sum(duplicated(activity))
sum(duplicated(sleep))
sum(duplicated(intensities))
sum(duplicated(steps))
sum(duplicated(calories))
sum(duplicated(weight))
sum(duplicated(hourly_intensities))
sum(duplicated(hourly_steps))
```
### get rid of duplicates in sleep
```{r}
sleep <- sleep %>% 
  distinct() %>% 
  drop_na()
```
### ensure the duplicates were removed successfully
```{r}
sum(duplicated(sleep))
```


## Data limitations  

* This data does not have gender as a collected variable. This will make it more difficult to make specifically women-based recommendations.   
* This data was collected over a period of only one month.
* While most of the tables have 33 participants, sleep has only 24, and weight has only 8 participants. Although 8 participants isn't enough to make reasonable predictions, weight is obviously a feature that most participants chose not to use, which is revealing in it's own right. 
  
    
      
      

# **Before analyzing:**  
  
    
    
Correct the date format:  

```{r}
# intensities table
intensities$ActivityDay=as.POSIXct(intensities$ActivityDay, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
intensities$date <- format(intensities$ActivityDay, format = "%m/%d/%y") 

# activity table
activity$ActivityDate=as.POSIXct(activity$ActivityDate, format="%m/%d/%Y", tz=Sys.timezone())
activity$date <- format(activity$ActivityDate, format = "%m/%d/%y")

# sleep table
sleep$SleepDay=as.POSIXct(sleep$SleepDay, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
sleep$date <- format(sleep$SleepDay, format = "%m/%d/%y")

# weight table
weight$Date=as.POSIXct(weight$Date, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
weight$date <- format(weight$Date, format = "%m/%d/%y %h:%M:%S %p")

# calories table
calories$ActivityDay=as.POSIXct(calories$ActivityDay, format="%m/%d/%Y", tz=Sys.timezone())
calories$date <- format(calories$ActivityDay, format = "%m/%d/%y")

# hourly steps table
hourly_steps$ActivityHour=as.POSIXct(hourly_steps$ActivityHour, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
sleep$date <- format(sleep$SleepDay, format = "%m/%d/%y %h:%M:%S %p")

# hourly intensities table
hourly_intensities$ActivityHour=as.POSIXct(hourly_steps$ActivityHour, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
sleep$date <- format(sleep$SleepDay, format = "%m/%d/%y %h:%M:%S %p")

```
  

Clean column names:
```{r}
activity <- activity %>% 
  clean_names() %>% 
  rename_with(tolower)

sleep <- sleep %>% 
  clean_names() %>% 
  rename_with(tolower)

intensities <- intensities %>% 
  clean_names() %>% 
  rename_with(tolower)

steps <- steps %>% 
  clean_names() %>% 
  rename_with(tolower)

weight <- weight %>% 
  clean_names() %>% 
  rename_with(tolower)

calories <- calories %>% 
  clean_names() %>% 
  rename_with(tolower)

hourly_steps <- hourly_steps %>% 
  clean_names() %>% 
  rename_with(tolower)

hourly_intensities <- hourly_intensities %>% 
  clean_names() %>% 
  rename_with(tolower)
```

 
Create a new column in my activity table that is the total daily active minutes:  

```{r}
# first I make a data frame using the data I need for the new column
active_minutes <- data.frame(activity$very_active_minutes, 
+                             activity$fairly_active_minutes, 
+                             activity$lightly_active_minutes)

# make new column out of row sums of the new data frame
activity$total_active_minutes <- rowSums(active_minutes)
```

  
    
Create a new column in the sleep table for the time spent awake in bed:
```{r}
sleep$total_waketime_in_bed <- (sleep$total_time_in_bed - sleep$total_minutes_asleep)
```

Create a new column using only the hours for the hourly tables
```{r}
hourly_steps$hour <- format(as.POSIXct(hourly_steps$activity_hour), format = "%H")

hourly_intensities$hour <- format(as.POSIXct(hourly_intensities$activity_hour), format = "%H")
```



# Next, I get summarized statistics for my datasets
```{r}
# activity table summary
activity %>%  
  select(total_steps,
         total_distance,
         sedentary_minutes, total_active_minutes) %>%
  summary()

# active minutes per category
activity %>%
  select(very_active_minutes, fairly_active_minutes, lightly_active_minutes) %>%
  summary()

# sleep
sleep %>%
  select(total_sleep_records, total_minutes_asleep, total_time_in_bed, total_waketime_in_bed) %>%
  summary()

# weight
weight %>% 
  select(weight_pounds,bmi) %>% 
  summary()

# calories
calories %>% 
  select(calories) %>% 
  summary()

# hourly steps
hourly_steps %>% 
  select(step_total) %>% 
  summary()

# hourly intensities
hourly_intensities %>% 
  select(average_intensity, total_intensity) %>% 
  summary()
```



# **Insights from first glance at data tables**  
* On average, participants were sedentary 991.2 minutes per day, and an average of 46.27% of that  being spent in bed.
* This data does not have gender as a collected variable. This will make it more difficult to make specifically women-based recommendations(especially prevalent with weight and calories). So I will focus on the activity, sleep, steps, and intensities data frames.   
* The average participant was only "very active" intensity for 21.16 minutes per day, with most active minutes being "lightly active" intensity, averaging at 192.8 minutes per day.
* 39.17 minutes was the average time participants spent laying awake while in bed
* Although so few people reported their weights, the data pool has a large span of weights. (min:116.0 max:294.3)

# Merge tables for data viz
```{r}
merged_daily_data <- merge(activity, sleep, by = c ("id", "date"), all = TRUE)

merged_hourly_data <- merge(hourly_steps, hourly_intensities, by =c("id", "activity_hour", "hour"))

```

    
      
      
# Visualizations  
  
    
```{r}
ggplot(data=merged_daily_data, aes(x=total_minutes_asleep, y=sedentary_minutes)) + 
  geom_point(color='darkblue') + geom_smooth() +
  labs(title="Minutes Asleep vs. Sedentary Minutes", x="Minutes Asleep", y="Minutes Sedentary")  
  
  
ggplot(data=merged_daily_data, aes(x=total_steps, y=total_active_minutes)) +
  geom_point() + 
  labs(title = "Active Minutes and Total Steps", x="Total Steps", y="Total Active Minutes")  
  
 ggplot(data=merged_hourly_data, aes(x=step_total, y=hour, color= average_intensity)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 90))+
  labs(title= "Total steps by hour", subtitle="Highlighting the peak active times", x="steps", y="hour")

```

